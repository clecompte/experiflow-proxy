# === EXPERIFLOW PROXY - PRODUCTION CONFIGURATION ===
# Copy this file to configure Railway environment variables
# DO NOT commit actual values - use Railway dashboard to set these

# === PROXY SETTINGS ===
# Port the proxy listens on (Railway will set PORT automatically)
PORT=8090

# Origin server URL - the website you want to proxy and run A/B tests on
# This should be your actual website/application URL
ORIGIN_URL=https://your-site.com

# HTTP timeouts
READ_TIMEOUT=10s
WRITE_TIMEOUT=10s

# === EXPERIFLOW API SETTINGS ===
# ExperiFlow API base URL (your deployed backend)
EXPERIFLOW_API_URL=https://api.experiflow.com

# Optional: Edge token for API authentication
# Leave empty if not using API authentication
EXPERIFLOW_EDGE_TOKEN=

# Timeout for transformation operations (keep low for performance)
TRANSFORM_TIMEOUT=50ms

# === EXPERIMENT CONFIGURATION ===
# Comma-separated list of experiment IDs to activate
# Get these from your ExperiFlow dashboard
# Example: EXPERIMENT_IDS=54ce9030-4da3-4866-8b25-6d956207f325,another-exp-id
EXPERIMENT_IDS=

# === FEATURE FLAGS ===
# Fail open: pass through requests on errors (HIGHLY RECOMMENDED for production)
FAIL_OPEN=true

# Enable request logging
ENABLE_LOGGING=true

# Enable metrics collection
ENABLE_METRICS=true

# === NOTES ===
# 1. The proxy does NOT need database access - it communicates with the API
# 2. The proxy does NOT store user data - only sets cookies for variant assignment
# 3. Keep TRANSFORM_TIMEOUT low (< 100ms) for best performance
# 4. Always set FAIL_OPEN=true in production to ensure site reliability
# 5. EXPERIMENT_IDS can be updated without redeploying - just restart the service

# === DEPLOYMENT WORKFLOW ===
# 1. Deploy your origin site (e.g., your-site.com)
# 2. Deploy ExperiFlow API (api.experiflow.com) - DONE ✅
# 3. Create experiment in ExperiFlow dashboard
# 4. Deploy this proxy with experiment ID
# 5. Point your domain to the proxy
# 6. Traffic flows: User → Proxy → Origin (with transformations applied)

# === EXAMPLE PRODUCTION SETUP ===
# PORT=8090
# ORIGIN_URL=https://www.example.com
# EXPERIFLOW_API_URL=https://api.experiflow.com
# EXPERIMENT_IDS=54ce9030-4da3-4866-8b25-6d956207f325
# FAIL_OPEN=true
# TRANSFORM_TIMEOUT=50ms
